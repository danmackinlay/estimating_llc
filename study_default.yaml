# study_default.yaml
base:
  # ---- Target/model/data (defaults) ----
  target: mlp
  in_dim: 32
  out_dim: 1
  depth: 3
  widths: null            # inferred from target_params if set
  activation: relu
  bias: true
  skip_connections: false
  residual_period: 2
  layernorm: false
  init: he

  target_params: 10000
  hidden: 300

  n_data: 20000
  x_dist: gauss_iso
  cov_decay: 0.95
  mixture_k: 4
  mixture_spread: 2.0
  x_dim_latent: 2
  noise_model: gauss
  noise_scale: 0.1
  hetero_scale: 0.1
  student_df: 4.0
  outlier_frac: 0.05
  outlier_scale: 2.0

  teacher_depth: null
  teacher_widths: null
  teacher_activation: null
  teacher_dropout_rate: 0.0

  loss: mse

  beta_mode: 1_over_log_n
  beta0: 1.0
  prior_radius: null
  gamma: 1.0
  prior_center: null
  reference_for_L0: null

  # ---- Samplers (defaults) ----
  # SGLD
  sgld_steps: 16000
  sgld_warmup: 1000
  sgld_batch_size: 256
  sgld_step_size: 1e-6
  sgld_thin: 20
  sgld_eval_every: 10
  sgld_dtype: float32
  sgld_precond: none
  sgld_beta1: 0.9
  sgld_beta2: 0.999
  sgld_eps: 1e-8
  sgld_bias_correction: true

  # SGHMC
  sghmc_steps: 12000
  sghmc_warmup: 1000
  sghmc_batch_size: 256
  sghmc_step_size: 1e-6
  sghmc_temperature: 1.0
  sghmc_thin: 20
  sghmc_eval_every: 10
  sghmc_dtype: float32

  # HMC
  hmc_draws: 5000
  hmc_warmup: 1000
  hmc_num_integration_steps: 10
  hmc_thin: 5
  hmc_eval_every: 1
  hmc_dtype: float64

  # MCLMC (BlackJAX 1.2.5 fractional API)
  mclmc_draws: 8000
  mclmc_eval_every: 1
  mclmc_thin: 10
  mclmc_dtype: float64
  mclmc_num_steps: 2000
  mclmc_frac_tune1: 0.1
  mclmc_frac_tune2: 0.1
  mclmc_frac_tune3: 0.1
  mclmc_diagonal_preconditioning: false
  mclmc_desired_energy_var: 5e-4
  mclmc_trust_in_estimate: 1.0
  mclmc_num_effective_samples: 150.0
  mclmc_integrator: isokinetic_mclachlan
  mclmc_adjusted: false
  mclmc_adjusted_target_accept: 0.90
  mclmc_grad_per_step_override: null

  # Chains & diagnostics
  samplers: [sgld, sghmc, hmc, mclmc]   # sweep splits one job per sampler
  chains: 4
  use_batched_chains: false             # CLI --gpu-mode controls this at runtime
  diag_mode: proj
  diag_k: 16
  diag_seed: 1234
  max_theta_plot_dims: 8

  # Artifacts
  runs_dir: runs
  save_plots: false
  show_plots: false
  auto_create_run_dir: true
  save_manifest: true
  save_readme_snippet: true
  auto_update_readme: false

problems:
  - name: default
    overrides: {}    # use base as-is

samplers:
  - name: sgld
    overrides: {}
  - name: sghmc
    overrides: {}
  - name: hmc
    overrides: {}
  - name: mclmc
    overrides: {}
