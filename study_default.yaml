base:
  # Target/model/data
  target: mlp
  in_dim: 32
  out_dim: 1
  depth: 3
  widths: null
  activation: relu
  target_params: 10000
  n_data: 20000
  x_dist: gauss_iso
  noise_model: gauss
  noise_scale: 0.1
  student_df: 4.0
  loss: mse

  # Posterior
  beta_mode: 1_over_log_n
  beta0: 1.0
  prior_radius: null
  gamma: 1.0

  # Sampling
  chains: 4
  use_batched_chains: true

  # SGLD
  sgld_steps: 16000
  sgld_warmup: 1000
  sgld_batch_size: 256
  sgld_step_size: 1e-6
  sgld_thin: 20
  sgld_eval_every: 10
  sgld_dtype: float32
  sgld_precond: none
  sgld_beta1: 0.9
  sgld_beta2: 0.999
  sgld_eps: 1e-8
  sgld_bias_correction: true

  # HMC
  hmc_draws: 5000
  hmc_warmup: 1000
  hmc_num_integration_steps: 10
  hmc_thin: 5
  hmc_eval_every: 1
  hmc_dtype: float64

  # MCLMC (BlackJAX 1.2.5 fractional API)
  mclmc_draws: 8000
  mclmc_eval_every: 1
  mclmc_thin: 10
  mclmc_dtype: float64
  mclmc_num_steps: 2000
  mclmc_frac_tune1: 0.1
  mclmc_frac_tune2: 0.1
  mclmc_frac_tune3: 0.1
  mclmc_diagonal_preconditioning: false
  mclmc_desired_energy_var: 5e-4
  mclmc_trust_in_estimate: 1.0
  mclmc_num_effective_samples: 150.0
  mclmc_integrator: isokinetic_mclachlan

  # Misc
  seed: 42
  runs_dir: runs
  save_plots: false
  show_plots: false

problems:
  - name: default
    overrides: {}

samplers:
  - name: sgld
    overrides: {}
  - name: hmc
    overrides: {}
  - name: mclmc
    overrides: {}

seeds: [42]